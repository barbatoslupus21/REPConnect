<table class="data-table" id="leaveRequestsTable">
	<thead>
		<tr>
			<th>Control Number</th>
			<th>Employee Name</th>
			<th>Department</th>
			<th>Leave Type</th>
			<th>Leave Reason</th>
			<th>Duration</th>
			<th>Status</th>
			<th>Date Prepared</th>
			<th style="text-align: center;">Actions</th>
		</tr>
	</thead>
	<tbody>
		{% for leave in leave_requests %}
			<tr data-leave-id="{{ leave.id }}">
				<td>
					<span class="control-number">{{ leave.control_number }}</span>
				</td>
				<td>
					<div class="employee-info">
						<span class="employee-name">{{ leave.employee.full_name }}</span>
						<small class="employee-id">{{ leave.employee.idnumber }}</small>
					</div>
				</td>
				<td>{{ leave.employee.employment_info.department.department_name|default:"N/A" }}</td>
				<td>{{ leave.leave_type.name }}</td>
				<td>{{ leave.leave_reason.reason_text|default:"N/A" }}</td>
				<td>{{ leave.duration_display }}</td>
				<td>
					<span class="status-badge status-{{ leave.status }}">
						{{ leave.get_status_display }}
					</span>
				</td>
				<td>{{ leave.date_prepared|date:"M d, Y" }}</td>
				<td>
					<div class="center-align">
						{% with last_action=leave.approval_actions.last %}
							{% if last_action and last_action.approver == user and last_action.status == 'routing' %}
								<button class="btn btn-sm btn-primary" data-action="open-approval" data-control-number="{{ leave.control_number }}" title="Review & Approve">
									<i class="fas fa-check"></i> Review
								</button>
							{% else %}
								<button class="btn btn-icon" data-action="view-details" data-control-number="{{ leave.control_number }}" title="View Details">
									<i class="fas fa-eye"></i>
								</button>
							{% endif %}
						{% endwith %}
					</div>
				</td>
			</tr>
		{% empty %}
			<tr>
				<td colspan="9" class="text-center">
					<div class="empty-state">
						<i class="fas fa-calendar-alt"></i>
						<h5>No Leave Requests Found</h5>
						<p>No leave requests match your current filters.</p>
					</div>
				</td>
			</tr>
		{% endfor %}
	</tbody>
</table>
